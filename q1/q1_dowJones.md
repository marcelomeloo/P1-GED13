>### Dados Dow Jones

```r
  dados.dj <- quantmod::getSymbols("^DJI",src = "yahoo", from = start,to = end,auto.assign = FALSE)
  dados.dj
```

```
##            DJI.Open DJI.High  DJI.Low DJI.Close DJI.Volume DJI.Adjusted
## 2022-01-03 36321.59 36595.82 36246.45  36585.06  347930000     36585.06
## 2022-01-04 36636.00 36934.84 36636.00  36799.65  435080000     36799.65
## 2022-01-05 36722.60 36952.65 36400.39  36407.11  462040000     36407.11
## 2022-01-06 36409.05 36464.19 36200.68  36236.47  385890000     36236.47
## 2022-01-07 36249.59 36382.84 36111.53  36231.66  356110000     36231.66
## 2022-01-10 36175.21 36175.21 35639.91  36068.87  430680000     36068.87
## 2022-01-11 36058.85 36271.47 35769.38  36252.02  356850000     36252.02
## 2022-01-12 36336.16 36453.49 36168.15  36290.32  310180000     36290.32
## 2022-01-13 36312.49 36513.88 36044.22  36113.62  343640000     36113.62
## 2022-01-14 35996.43 35996.43 35641.49  35911.81  389200000     35911.81
## 2022-01-18 35661.76 35661.76 35262.02  35368.47  427260000     35368.47
## 2022-01-19 35412.30 35547.83 35015.49  35028.65  393080000     35028.65
## 2022-01-20 35102.66 35490.20 34670.12  34715.39  369070000     34715.39
## 2022-01-21 34701.69 34896.67 34229.55  34265.37  523880000     34265.37
## 2022-01-24 34070.61 34420.99 33150.33  34364.50  664010000     34364.50
## 2022-01-25 34186.64 34591.04 33545.52  34297.73  506430000     34297.73
## 2022-01-26 34520.82 34815.67 33876.48  34168.09  546330000     34168.09
## 2022-01-27 34261.75 34773.32 34007.78  34160.78  527780000     34160.78
## 2022-01-28 34135.24 34731.77 33807.51  34725.47  568440000     34725.47
## 2022-01-31 34691.17 35148.14 34496.10  35131.86  468070000     35131.86
## 2022-02-01 35151.47 35441.09 34977.95  35405.24  386080000     35405.24
## 2022-02-02 35378.19 35679.20 35290.12  35629.33  359540000     35629.33
## 2022-02-03 35520.08 35535.94 35071.06  35111.16  381020000     35111.16
## 2022-02-04 35095.74 35333.55 34799.08  35089.74  349880000     35089.74
## 2022-02-07 35108.38 35325.01 34993.98  35091.13  328910000     35091.13
## 2022-02-08 35160.68 35544.89 35090.42  35462.78  319190000     35462.78
## 2022-02-09 35614.90 35824.28 35614.90  35768.06  333610000     35768.06
## 2022-02-10 35630.81 35800.24 35100.72  35241.59  411620000     35241.59
## 2022-02-11 35267.89 35431.15 34620.52  34738.06  398860000     34738.06
## 2022-02-14 34694.50 34744.56 34304.28  34566.17  370320000     34566.17
## 2022-02-15 34686.19 35047.79 34686.19  34988.84  305670000     34988.84
## 2022-02-16 34951.83 35042.09 34642.64  34934.27  294410000     34934.27
## 2022-02-17 34858.47 34858.47 34246.23  34312.03  348720000     34312.03
## 2022-02-18 34310.45 34423.58 33976.18  34079.18  414080000     34079.18
## 2022-02-22 33974.09 34024.74 33364.29  33596.61  432090000     33596.61
## 2022-02-23 33680.97 33832.59 33084.90  33131.76  370600000     33131.76
## 2022-02-24 32830.33 33269.34 32272.64  33223.83  590850000     33223.83
## 2022-02-25 33277.22 34095.74 33277.22  34058.75  417630000     34058.75
## 2022-02-28 33870.62 33963.63 33469.31  33892.60  443460000     33892.60
## 2022-03-01 33813.48 33870.14 33107.67  33294.95  438730000     33294.95
## 2022-03-02 33379.51 34013.67 33379.51  33891.35  400920000     33891.35
## 2022-03-03 33972.87 34179.07 33641.53  33794.66  369740000     33794.66
## 2022-03-04 33655.43 33655.43 33254.12  33614.80  408390000     33614.80
## 2022-03-07 33579.75 33579.75 32806.15  32817.38  488400000     32817.38
## 2022-03-08 32885.17 33402.98 32578.73  32632.64  553750000     32632.64
## 2022-03-09 32860.42 33457.28 32860.42  33286.25  418670000     33286.25
## 2022-03-10 33106.77 33236.59 32819.76  33174.07  399480000     33174.07
## 2022-03-11 33279.72 33515.61 32911.89  32944.19  369480000     32944.19
## 2022-03-14 33000.37 33395.59 32818.16  32945.24  394940000     32945.24
## 2022-03-15 32989.27 33620.84 32989.27  33544.34  388810000     33544.34
## 2022-03-16 33653.93 34075.94 33391.24  34063.10  427400000     34063.10
## 2022-03-17 33995.39 34483.92 33896.06  34480.76  339470000     34480.76
## 2022-03-18 34466.72 34755.20 34279.83  34754.93  615420000     34754.93
## 2022-03-21 34669.85 34808.28 34341.81  34552.99  408490000     34552.99
## 2022-03-22 34583.24 34882.03 34583.24  34807.46  368550000     34807.46
## 2022-03-23 34748.84 34748.84 34352.96  34358.50  347880000     34358.50
## 2022-03-24 34406.81 34713.56 34355.42  34707.94  324870000     34707.94
## 2022-03-25 34702.39 34942.70 34631.52  34861.24  285440000     34861.24
## 2022-03-28 34833.03 34957.93 34552.23  34955.89  299790000     34955.89
## 2022-03-29 35114.35 35372.26 35030.07  35294.19  355050000     35294.19
## 2022-03-30 35273.63 35361.36 35058.58  35228.81  317320000     35228.81
## 2022-03-31 35201.52 35201.52 34677.99  34678.35  433400000     34678.35
## 2022-04-01 34740.89 34847.91 34538.25  34818.27  340400000     34818.27
## 2022-04-04 34799.98 34940.78 34615.38  34921.88  316570000     34921.88
## 2022-04-05 34876.33 35112.21 34566.04  34641.18  304010000     34641.18
## 2022-04-06 34520.34 34609.84 34277.17  34496.51  386250000     34496.51
## 2022-04-07 34439.24 34705.83 34190.95  34583.57  319870000     34583.57
## 2022-04-08 34569.24 34908.46 34470.19  34721.12  301750000     34721.12
## 2022-04-11 34630.27 34701.34 34272.29  34308.08  333290000     34308.08
## 2022-04-12 34412.51 34669.97 34102.81  34220.36  333510000     34220.36
## 2022-04-13 34166.64 34598.36 34140.64  34564.59  313630000     34564.59
## 2022-04-14 34628.46 34889.17 34437.50  34451.23  353680000     34451.23
## 2022-04-18 34411.49 34618.29 34279.08  34411.69  264110000     34411.69
## 2022-04-19 34394.62 34983.11 34394.62  34911.20  296350000     34911.20
## 2022-04-20 34962.67 35315.40 34962.67  35160.79  337620000     35160.79
## 2022-04-21 35258.80 35492.22 34723.82  34792.76  366390000     34792.76
## 2022-04-22 34727.38 34727.38 33773.39  33811.40  373280000     33811.40
## 2022-04-25 33731.65 34106.01 33323.37  34049.46  416900000     34049.46
## 2022-04-26 33907.49 33909.51 33230.95  33240.18  400020000     33240.18
## 2022-04-27 33450.92 33697.18 33108.89  33301.93  447230000     33301.93
## 2022-04-28 33425.96 34054.79 33248.46  33916.39  440380000     33916.39
## 2022-04-29 33787.01 33919.59 32913.15  32977.21  501560000     32977.21
## 2022-05-02 32978.49 33224.95 32449.87  33061.50  453390000     33061.50
## 2022-05-03 33086.09 33341.58 32914.75  33128.79  364420000     33128.79
## 2022-05-04 33171.80 34117.74 33021.84  34061.06  411060000     34061.06
## 2022-05-05 33854.17 33854.17 32685.10  32997.97  448420000     32997.97
## 2022-05-06 32773.88 33055.84 32474.69  32899.37  416520000     32899.37
## 2022-05-09 32685.17 32685.17 32121.98  32245.70  470770000     32245.70
## 2022-05-10 32504.09 32752.17 31887.89  32160.74  439290000     32160.74
## 2022-05-11 32123.24 32584.02 31798.86  31834.11  458460000     31834.11
## 2022-05-12 31699.04 31914.46 31228.22  31730.30  544240000     31730.30
## 2022-05-13 31963.86 32276.05 31862.79  32196.66  388520000     32196.66
## 2022-05-16 32152.15 32514.02 31928.18  32223.42  330030000     32223.42
## 2022-05-17 32427.00 32689.14 32308.15  32654.59  389310000     32654.59
## 2022-05-18 32468.67 32468.67 31393.95  31490.07  465060000     31490.07
## 2022-05-19 31262.62 31569.13 31016.41  31253.13  517190000     31253.13
## 2022-05-20 31426.94 31515.78 30635.76  31261.90  495510000     31261.90
## 2022-05-23 31395.89 31968.42 31395.89  31880.24  402010000     31880.24
## 2022-05-24 31717.61 32014.86 31365.59  31928.62  382950000     31928.62
## 2022-05-25 31816.31 32254.44 31754.33  32120.28  343460000     32120.28
## 2022-05-26 32248.17 32774.14 32248.17  32637.19  351220000     32637.19
## 2022-05-27 32735.09 33213.62 32682.01  33212.96  328770000     33212.96
## 2022-05-31 33160.59 33240.22 32752.34  32990.12  533560000     32990.12
## 2022-06-01 33156.31 33272.34 32584.76  32813.23  338210000     32813.23
## 2022-06-02 32809.01 33248.61 32509.43  33248.28  333210000     33248.28
## 2022-06-03 32986.32 33135.61 32839.21  32899.70  298570000     32899.70
## 2022-06-06 33032.04 33235.37 32819.50  32915.78  253010000     32915.78
## 2022-06-07 32783.03 33207.45 32641.85  33180.14  270750000     33180.14
## 2022-06-08 33087.07 33156.50 32824.37  32910.90  270470000     32910.90
## 2022-06-09 32828.62 32956.73 32267.78  32272.79  289710000     32272.79
## 2022-06-10 32053.52 32053.52 31387.84  31392.79  362300000     31392.79
## 2022-06-13 31144.91 31144.91 30373.72  30516.74  472290000     30516.74
## 2022-06-14 30592.34 30690.80 30144.23  30364.83  366800000     30364.83
## 2022-06-15 30570.50 31011.97 30185.08  30668.53  392670000     30668.53
## 2022-06-16 30305.74 30305.74 29740.35  29927.07  442910000     29927.07
## 2022-06-17 29912.70 30167.52 29653.29  29888.78  692830000     29888.78
## 2022-06-21 30074.69 30653.98 30074.69  30530.25  376900000     30530.25
## 2022-06-22 30352.57 30777.92 30166.01  30483.13  343490000     30483.13
## 2022-06-23 30570.33 30715.63 30293.40  30677.36  361420000     30677.36
## 2022-06-24 30846.94 31517.29 30846.94  31500.68  465480000     31500.68
## 2022-06-27 31533.60 31598.59 31351.37  31438.26  309910000     31438.26
## 2022-06-28 31549.05 31885.09 30934.33  30946.99  350780000     30946.99
## 2022-06-29 31067.41 31152.96 30894.53  31029.31  269390000     31029.31
## 2022-06-30 30790.00 30979.85 30431.87  30775.43  394070000     30775.43
## 2022-07-01 30737.77 31139.35 30487.79  31097.26  310440000     31097.26
## 2022-07-05 30903.12 30971.74 30355.12  30967.82  323080000     30967.82
## 2022-07-06 30957.30 31224.69 30794.84  31037.68  289800000     31037.68
## 2022-07-07 31190.65 31421.84 31154.64  31384.55  296620000     31384.55
## 2022-07-08 31348.43 31511.46 31212.45  31338.15  238120000     31338.15
## 2022-07-11 31277.98 31367.55 31114.40  31173.84  245020000     31173.84
## 2022-07-12 31113.31 31346.10 30860.51  30981.33  324190000     30981.33
## 2022-07-13 30743.63 30979.17 30514.61  30772.79  291830000     30772.79
## 2022-07-14 30451.80 30680.12 30143.93  30630.17  325130000     30630.17
## 2022-07-15 30775.37 31288.26 30775.37  31288.26  321570000     31288.26
## 2022-07-18 31475.98 31644.68 30982.97  31072.61  309960000     31072.61
## 2022-07-19 31165.91 31842.25 31165.91  31827.05  378720000     31827.05
## 2022-07-20 31829.99 31944.45 31646.95  31874.84  313520000     31874.84
## 2022-07-21 31826.49 32040.63 31534.08  32036.90  302320000     32036.90
## 2022-07-22 32167.92 32219.25 31731.47  31899.29  319880000     31899.29
## 2022-07-25 31950.93 32029.03 31821.67  31990.04  255450000     31990.04
## 2022-07-26 31950.04 31950.04 31705.36  31761.54  324930000     31761.54
## 2022-07-27 31865.05 32336.23 31799.43  32197.59  365480000     32197.59
## 2022-07-28 32197.62 32609.54 31982.61  32529.63  331110000     32529.63
## 2022-07-29 32515.62 32910.18 32493.02  32845.13  487360000     32845.13
## 2022-08-01 32755.71 32972.03 32640.79  32798.40  321180000     32798.40
## 2022-08-02 32691.29 32772.93 32387.12  32396.17  316740000     32396.17
## 2022-08-03 32514.21 32912.74 32514.21  32812.50  342160000     32812.50
## 2022-08-04 32805.69 32829.22 32652.63  32726.82  315590000     32726.82
## 2022-08-05 32593.90 32814.61 32489.62  32803.47  273010000     32803.47
## 2022-08-08 32877.36 33109.96 32769.10  32832.54  275350000     32832.54
## 2022-08-09 32807.36 32877.53 32702.66  32774.41  281080000     32774.41
## 2022-08-10 33130.63 33364.41 33130.63  33309.51  311740000     33309.51
## 2022-08-11 33451.51 33651.80 33289.83  33336.67  308030000     33336.67
## 2022-08-12 33430.72 33767.09 33398.32  33761.05  299140000     33761.05
## 2022-08-15 33710.70 33954.71 33582.96  33912.44  262670000     33912.44
## 2022-08-16 33924.35 34281.36 33852.57  34152.01  288670000     34152.01
## 2022-08-17 34029.55 34161.01 33828.41  33980.32  281390000     33980.32
## 2022-08-18 33981.86 34043.83 33844.46  33999.04  282550000     33999.04
## 2022-08-19 33904.69 33904.69 33627.09  33706.74  293990000     33706.74
## 2022-08-22 33586.59 33586.59 33007.63  33063.61  308900000     33063.61
## 2022-08-23 33033.52 33138.26 32858.89  32909.59  251870000     32909.59
## 2022-08-24 32899.01 33095.50 32828.56  32969.23  256900000     32969.23
## 2022-08-25 33029.27 33306.09 32889.85  33291.78  308530000     33291.78
## 2022-08-26 33293.43 33364.70 32278.22  32283.40  352850000     32283.40
## 2022-08-29 32188.00 32325.16 31972.79  32098.99  317820000     32098.99
## 2022-08-30 32163.84 32205.66 31647.22  31790.87  317150000     31790.87
## 2022-08-31 31827.15 31966.04 31509.59  31510.43  392780000     31510.43
```

```r
  dj <- na.omit(dados.dj)
```

#### Cria o vetor de preco de fechamento

```r
  preco_fechamento <- dados.dj$"DJI.Close"
```

#### 1. Media do Preco de Fechamento ----

```r
  media_pf <- mean(preco_fechamento)
  media_pf
```

```
## [1] 33333.56
```

#### 2. Moda do Preco de Fechamento ----

```r
  tab_preco_fechamento <- table(preco_fechamento)
  moda_pf <- names(tab_preco_fechamento)[which(tab_preco_fechamento==max(tab_preco_fechamento))]
  moda_pf
```

```
##   [1] "29888.779297" "29927.070313" "30364.830078" "30483.130859" "30516.740234" "30530.25"     "30630.169922" "30668.529297" "30677.359375" "30772.789063" "30775.429688"
##  [12] "30946.990234" "30967.820313" "30981.330078" "31029.310547" "31037.679688" "31072.609375" "31097.259766" "31173.839844" "31253.130859" "31261.900391" "31288.259766"
##  [23] "31338.150391" "31384.550781" "31392.789063" "31438.259766" "31490.070313" "31500.679688" "31510.429688" "31730.300781" "31761.539063" "31790.869141" "31827.050781"
##  [34] "31834.109375" "31874.839844" "31880.240234" "31899.289063" "31928.619141" "31990.039063" "32036.900391" "32098.990234" "32120.279297" "32160.740234" "32196.660156"
##  [45] "32197.589844" "32223.419922" "32245.699219" "32272.789063" "32283.400391" "32396.169922" "32529.630859" "32632.640625" "32637.189453" "32654.589844" "32726.820313"
##  [56] "32774.410156" "32798.398438" "32803.46875"  "32812.5"      "32813.230469" "32817.378906" "32832.539063" "32845.128906" "32899.371094" "32899.699219" "32909.589844"
##  [67] "32910.898438" "32915.78125"  "32944.191406" "32945.238281" "32969.230469" "32977.210938" "32990.121094" "32997.96875"  "33061.5"      "33063.609375" "33128.789063"
##  [78] "33131.761719" "33174.070313" "33180.140625" "33212.960938" "33223.828125" "33240.179688" "33248.28125"  "33286.25"     "33291.78125"  "33294.949219" "33301.929688"
##  [89] "33309.511719" "33336.671875" "33544.339844" "33596.609375" "33614.800781" "33706.738281" "33761.050781" "33794.660156" "33811.398438" "33891.351563" "33892.601563"
## [100] "33912.441406" "33916.390625" "33980.320313" "33999.039063" "34049.460938" "34058.75"     "34061.058594" "34063.101563" "34079.179688" "34152.011719" "34160.78125" 
## [111] "34168.089844" "34220.359375" "34265.371094" "34297.730469" "34308.078125" "34312.03125"  "34358.5"      "34364.5"      "34411.691406" "34451.230469" "34480.761719"
## [122] "34496.511719" "34552.988281" "34564.589844" "34566.171875" "34583.570313" "34641.179688" "34678.351563" "34707.941406" "34715.390625" "34721.121094" "34725.46875" 
## [133] "34738.058594" "34754.929688" "34792.761719" "34807.460938" "34818.269531" "34861.238281" "34911.199219" "34921.878906" "34934.269531" "34955.890625" "34988.839844"
## [144] "35028.648438" "35089.738281" "35091.128906" "35111.160156" "35131.859375" "35160.789063" "35228.808594" "35241.589844" "35294.191406" "35368.46875"  "35405.238281"
## [155] "35462.78125"  "35629.328125" "35768.058594" "35911.808594" "36068.871094" "36113.621094" "36231.660156" "36236.46875"  "36252.019531" "36290.320313" "36407.109375"
## [166] "36585.058594" "36799.648438"
```

#### 3. Mediana do Preco de Fechamento ----

```r
  mediana_pf <- median(preco_fechamento)
  mediana_pf
```

```
## [1] 33248.28
```

#### 4. Variancia Nao Viesada ----

```r
  variancia_pf <- var(preco_fechamento)
  variancia_pf
```

```
##           DJI.Close
## DJI.Close   2520219
```

#### 5. Desvio-padrao ----

```r
  desv_pad_pf <- sd(preco_fechamento)
  desv_pad_pf
```

```
## [1] 1587.52
```

#### 6. Grafico de linha do Preco de Fechamento ----

```r
  ggplot(dados.dj, aes(x = index(dados.dj), y = preco_fechamento)) + geom_line() +labs(title="Grafico do Dow Jones", subtitle="Preco de Fechamento", caption="Fonte: https://finance.yahoo.com/", x = "Data ", y="Preco (R$)") +theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5)) +scale_x_date(date_labels = "%b %y", date_breaks = "1 month")
```

```
## Don't know how to automatically pick scale for object of type xts/zoo. Defaulting to continuous.
```

![plot of chunk unnamed-chunk-8](figure/unnamed-chunk-8-1.png)

#### 7. Retorno, com base no Preco de Fechamento ----

```r
  retorno_pf <- (preco_fechamento - shift(preco_fechamento, 1L, type="lag"))/shift(preco_fechamento, 1L, type="lag")
  retorno_pf <- na.omit(retorno_pf)
  tabela_preco_retorno <- cbind(preco_fechamento, retorno_pf)
  head(tabela_preco_retorno)
```

```
##            DJI.Close   DJI.Close.1
## 2022-01-03  36585.06            NA
## 2022-01-04  36799.65  0.0058655050
## 2022-01-05  36407.11 -0.0106669243
## 2022-01-06  36236.47 -0.0046870138
## 2022-01-07  36231.66 -0.0001327004
## 2022-01-10  36068.87 -0.0044930059
```

#### 8. Grafico de linha do Retorno ----

```r
  ggplot(retorno_pf, aes(x = index(retorno_pf), y = 100*retorno_pf)) +geom_line() +labs(title="Grafico do Dow Jones", subtitle="Retorno", caption="Fonte: https://finance.yahoo.com/", x = "Data ", y="Retorno (%)") +theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5)) +scale_x_date(date_labels = "%b %y", date_breaks = "1 month")
```

```
## Don't know how to automatically pick scale for object of type xts/zoo. Defaulting to continuous.
```

![plot of chunk unnamed-chunk-10](figure/unnamed-chunk-10-1.png)

#### 9. Box plot para dados originais (Preco de Fechamento e Retorno) e padronizados ----

```r
  boxplot_pf <- ggplot(data = preco_fechamento, aes(x = "", y = preco_fechamento))+
                      geom_violin(trim = FALSE, color="blue") +
                      geom_boxplot(width=0.4, color="blue", alpha = 1, outlier.size = 1) +
                      labs(x = "Preco", y = "") +
                      scale_y_continuous(breaks = seq(16, 23, by = 1))

  z_preco_fechamento <- (preco_fechamento - mean(preco_fechamento)) / sd(preco_fechamento)

  boxplot_z_pf <- ggplot(data = z_preco_fechamento, aes(x = "", y = z_preco_fechamento)) +
                        geom_violin(trim = FALSE, color="goldenrod3") +
                        geom_boxplot(width=0.4, color="red", alpha = 1, outlier.size = 1)+
                        labs(x = "Preco Padronizado", y = "") +
                        scale_y_continuous(breaks = seq(-5, 23, by = 1))

  boxplots_pf <- ggarrange(boxplot_pf, boxplot_z_pf,ncol = 2, nrow = 1)
  annotate_figure(boxplots_pf, top = text_grob("Boxplot/Vioplot do Preco de Fechamento\ne Preco de Fechamento Padronizado", color = "Black", face = "bold", size = 14), bottom = text_grob("Fonte: https://finance.yahoo.com/", color = "black", hjust = 1.02, x = 1,size = 10))
```

![plot of chunk unnamed-chunk-11](figure/unnamed-chunk-11-1.png)

```r
  boxplot_retorno <- ggplot(data = retorno_pf, aes(x = "", y = 100*retorno_pf)) +
                            geom_violin(trim = FALSE, color="blue") +
                            geom_boxplot(width=0.4, color="blue", alpha = 1, outlier.size = 1) +
                            labs(x = "Retorno (%)", y = "") +
                            scale_y_continuous(breaks = seq(-7, 6, by = 2))

  z_retorno_pf <- (retorno_pf - mean(retorno_pf))/(sd(retorno_pf))

  boxplot_z_retorno_pf <- ggplot(data = z_retorno_pf, aes(x = "", y = z_retorno_pf)) +
                            geom_violin(trim = FALSE, color="red") +
                            geom_boxplot(width=0.4, color="red", alpha = 1, outlier.size = 1) +
                            labs(x = "Retorno Padronizado", y = "") +
                            scale_y_continuous(breaks = seq(-3, 11, by = 2))

  boxplots_retorno <- ggarrange(boxplot_retorno, boxplot_z_retorno_pf,ncol = 2, nrow = 1)
  annotate_figure(boxplots_retorno, top = text_grob("Boxplot/Vioplot do Retorno\ne Retorno Padronizado",
                  color = "Black", face = "bold", size = 14),
                  bottom = text_grob("Fonte: https://finance.yahoo.com/",
                  color = "black", hjust = 1.02, x = 1, size = 10))
```

![plot of chunk unnamed-chunk-11](figure/unnamed-chunk-11-2.png)


#### 10. Histograma para dados originais (Preco de Fechamento e Retorno) e padronizados ----

```r
  histograma_pf <- ggplot(data = preco_fechamento,aes(x = preco_fechamento)) +
                          geom_histogram(color="blue", fill = "white", bins = 30) +
                          labs(y = "Quantidade", x = "Preco") +
                          scale_x_continuous(breaks = seq(17, 22, by = 0.5)) +
                          scale_y_continuous(breaks = seq(0, 30, by = 5)) +
                          theme(plot.title = element_text(hjust = 0.5))

  histograma_z_pf <- ggplot(data = z_preco_fechamento,aes(x = z_preco_fechamento)) +
                            geom_histogram(color="red", fill = "white", bins = 30) +
                            labs(y = "Quantidade", x = "Preco Padronizado") +
                            scale_x_continuous(breaks = seq(-2, 3.5, by = 0.5)) +
                            scale_y_continuous(breaks = seq(0, 50, by = 5)) +
                            theme(plot.title = element_text(hjust = 0.5))

  histogramas_pf <- ggarrange(histograma_pf, histograma_z_pf,ncol = 1, nrow = 2)
  annotate_figure(histogramas_pf, top = text_grob("Histograma do Preco de Fechamento",
                  color = "Black", face = "bold", size = 14),
                  bottom = text_grob("Fonte: https://finance.yahoo.com/",
                  color = "black", hjust = 1.02, x = 1, size = 10))
```

![plot of chunk unnamed-chunk-12](figure/unnamed-chunk-12-1.png)

```r
  histograma_retorno <- ggplot(data = retorno_pf,aes(x = 100*retorno_pf)) + 
                                geom_histogram(color="blue", fill = "white", bins = 25) + 
                                labs(y = "Quantidade", x = "Retorno (%)") + 
                                scale_x_continuous(breaks = seq(-6, 6, by = 1)) + 
                                scale_y_continuous(breaks = seq(0, 40, by = 5)) + 
                                theme(plot.title = element_text(hjust = 0.5))

  histograma_z_retorno <- ggplot(data = z_retorno_pf ,aes(x = z_retorno_pf)) + 
                                geom_histogram(color="red", fill = "white", bins = 25) + 
                                labs(y = "Quantidade", x = "Retorno Padronizado") + 
                                scale_x_continuous(breaks = seq(-6, 6, by = 1)) + 
                                scale_y_continuous(breaks = seq(0, 35, by = 5)) + 
                                theme(plot.title = element_text(hjust = 0.5))

  histogramas_retorno <- ggarrange(histograma_retorno, histograma_z_retorno,ncol = 1, nrow = 2)
  annotate_figure(histogramas_retorno, top = text_grob("Histograma do Retorno",
                  color = "Black", face = "bold", size = 14),
                  bottom = text_grob("Fonte: https://finance.yahoo.com/",
                  color = "black", hjust = 1.02, x = 1, size = 10))
```

![plot of chunk unnamed-chunk-12](figure/unnamed-chunk-12-2.png)

#### 11. QQPlot do retorno.  ----

```r
  qqplot_retorno <- ggplot(data = retorno_pf, aes(sample = 100*as.vector(retorno_pf))) +
                          stat_qq(size = 0.6) +labs(x = "Quantis Teoricos", y = "Quantis Amostrais",
                          title = "QQPlot do Retorno (%)") + theme(plot.title = element_text(hjust = 0.5)) +
                          scale_y_continuous(breaks = seq(-6, 4.5, by = 1.5))
```

#### 12. QQLine do retorno (fazer junto com o QQPlot).  ----

```r
  histograma_retorno_qqplot <- ggplot(data = retorno_pf,aes(x = 100*retorno_pf)) +
                                      geom_histogram(aes(y=..density..),color="blue", fill = "white", bins = 25) +
                                      stat_function(fun = dnorm, args = list(mean = mean(100*retorno_pf), sd = sd(100*retorno_pf)),
                                      col="red",lwd=1)+ theme(axis.text.x = element_blank(), axis.text.y = element_blank()) +
                                      labs(y = "", x = "") 

  qqplot_linha_retorno <- ggplot(data = retorno_pf, aes(sample = 100*as.vector(retorno_pf))) +
                                stat_qq(size = 0.6) + labs(x = "Quantis Teoricos", y = "Quantis Amostrais", title = "QQPlot do Retorno (%)") +
                                theme(plot.title = element_text(hjust = 0.5)) +scale_y_continuous(breaks = seq(-6, 4.5, by = 1.5)) +
                                stat_qq_line(col = 2,lwd=1,lty=1) 

  plot_principal <- qqplot_linha_retorno

  plot_para_inserir <- histograma_retorno_qqplot

  plot.com.insercao <- ggdraw() + draw_plot(plot_principal) + draw_plot(plot_para_inserir, x = 0.07, y = 0.6, width = .3, height = .3)
```

```
## Don't know how to automatically pick scale for object of type xts/zoo. Defaulting to continuous.
```

```r
  plot.com.insercao
```

![plot of chunk unnamed-chunk-14](figure/unnamed-chunk-14-1.png)

#### 13. Assimetria amostral n?o viesada do retorno.   ----

```r
  n <- length(retorno_pf)
  somatorio <- c()
  for(i in 1:n){
    somatorio[i] <- ((retorno_pf[i] - mean(retorno_pf))/ sd(retorno_pf))^3
  }
  p1_s3 <- n/((n -1)*(n-2))
  p2_s3 <- sum(somatorio)
  s3 <- p1_s3*p2_s3
  s3
```

```
## [1] -0.2224268
```

#### 14. Curtose amostral n?o viesada do retorno.   ----

```r
  n <- length(retorno_pf)
  somatorio <- c()
  for(i in 1:n){
    somatorio[i] <- ((retorno_pf[i] - mean(retorno_pf))/ sd(retorno_pf))^4
  }
  p1_s4 <- (n*(n +1))/((n -1)*(n-2)*(n-3))
  p2_s4 <- (sum(somatorio))
  p3_s4 <- (3*((n-1)^2))/((n-2)*(n-3))
  s4 <- p1_s4 * p2_s4 - p3_s4
  s4
```

```
## [1] 0.243152
```


```r
  library("knitr")
  knit("./q1/q1_dowJones.rmd", output = "./q1/q1_dowJones.md")
```

```
## Warning in file(con, "r"): cannot open file './q1/q1_dowJones.rmd': No such file or directory
```

```
## Error in file(con, "r"): cannot open the connection
```
